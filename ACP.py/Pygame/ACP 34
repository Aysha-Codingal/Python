import pygame
import random

pygame.init()

SWIDTH = 500
SHIEGHT = 400
screen = pygame.display.set_mode((SWIDTH, SHIEGHT))
pygame.display.set_caption("Add Custom Event - Color Change")
mspeed = 1

COLOR_CHANGE = pygame.USEREVENT + 1

pygame.time.set_timer(COLOR_CHANGE, 3000)

COLORS = ["green", "red", "blue", "yellow", "purple", "cyan", "magenta"]

class Sprite(pygame.sprite.Sprite):
    def __init__(self, color, h, w):
        super().__init__()
        self.image = pygame.Surface([w, h])
        self.original_color = color 
        self.image.fill(color)
        self.rect = self.image.get_rect()

    def move(self, xchange, ychange):
        self.rect.x = max(min(self.rect.x + xchange, SWIDTH - self.rect.w), 0)
        self.rect.y = max(min(self.rect.y + ychange, SHIEGHT - self.rect.h), 0)

    def change_color(self, new_color):
        """Method to change the sprite's image color."""
        self.image.fill(new_color)

clock = pygame.time.Clock()
all_sprites = pygame.sprite.Group()

sprite1 = Sprite("green", 30, 30)
sprite1.rect.x = 100
sprite1.rect.y = 200
all_sprites.add(sprite1)

sprite2 = Sprite("blue", 30, 30)
sprite2.rect.x = 350
sprite2.rect.y = 200
all_sprites.add(sprite2)

running = True
while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False

        if event.type == COLOR_CHANGE:
            new_color_1 = random.choice(COLORS)
            new_color_2 = random.choice(COLORS)

            sprite1.change_color(new_color_1)
            sprite2.change_color(new_color_2)
            print(f"Custom Event Triggered: Colors changed to {new_color_1} and {new_color_2}")

    keys = pygame.key.get_pressed()
    xchange = (keys[pygame.K_RIGHT] - keys[pygame.K_LEFT]) * mspeed
    ychange = (keys[pygame.K_DOWN] - keys[pygame.K_UP]) * mspeed

    sprite1.move(xchange, ychange)

    screen.fill("black")
    all_sprites.draw(screen)

    pygame.display.flip()

    clock.tick(60)

pygame.quit()